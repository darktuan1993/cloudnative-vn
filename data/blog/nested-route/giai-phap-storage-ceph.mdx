---
title: 'Gi·∫£i ph√°p v·ªÅ storage Cloud Native CEPH'
description: 'H∆∞·ªõng d·∫´n c√†i ƒë·∫∑t v√† ki·ªÉm tra Metrics Server ƒë·ªÉ theo d√µi t√†i nguy√™n trong c·ª•m Kubernetes'
date: '2022-04-08'
tags: ['Kubernetes', 'Ceph', 'DevOps', 'Rook']
authors: ['bachdangtuan']
---

# CEPH - The Future of Storage
Ceph l√† m·ªôt n·ªÅn t·∫£ng l∆∞u tr·ªØ ph√¢n t√°n (distributed storage platform) m√£ ngu·ªìn m·ªü, ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ cung c·∫•p kh·∫£ nƒÉng m·ªü r·ªông linh ho·∫°t, kh√¥ng ƒëi·ªÉm l·ªói ƒë∆°n (no single point of failure) v√† h·ªó tr·ª£ nhi·ªÅu ki·ªÉu l∆∞u tr·ªØ tr√™n c√πng m·ªôt n·ªÅn t·∫£ng.


### Th√†nh ph·∫ßn ch√≠nh c·ªßa CEPH nh∆∞ sau:

<b>RADOS</b>: L√µi l∆∞u tr·ªØ ph√¢n t√°n. T·∫•t c·∫£ d·ªØ li·ªáu trong Ceph ƒë·ªÅu l∆∞u tr·ªØ tr√™n RADOS.

<b>OSD (Object Storage Daemon)</b>: ƒê√¢y l√† d·ªãch v·ª• ch·ªãu tr√°ch nhi·ªám l∆∞u tr·ªØ d·ªØ li·ªáu tr√™n c√°c node
v·∫≠t l√Ω. M·ªói ·ªï ƒëƒ©a trong cluster s·∫Ω ch·∫°y m·ªôt OSD daemon.

<b>MON (Monitor Daemon)</b>: Duy tr√¨ tr·∫°ng th√°i cluster, qu·∫£n l√Ω th√¥ng tin c·∫•u h√¨nh, theo d√µi tr·∫°ng
th√°i c·ªßa c√°c OSD.

<b>MGR(Ceph Manager)</b>: Ceph Manager (MGR) l√† m·ªôt daemon b·ªï sung trong Ceph, ch·ªãu tr√°ch nhi·ªám thu
th·∫≠p s·ªë li·ªáu th·ªëng k√™, cung c·∫•p API qu·∫£n l√Ω, gi√°m s√°t cluster v√† h·ªó tr·ª£ c√°c module m·ªü r·ªông.

<b>MDS (Metadata Server - Ch·ªâ d√πng cho CephFS) </b>: X·ª≠ l√Ω metadata c·ªßa h·ªá th·ªëng file, gi√∫p tƒÉng t·ªëc
truy v·∫•n v√† qu·∫£n l√Ω c√¢y th∆∞ m·ª•c.

<b>RGW (RADOS Gateway) </b>: Cung c·∫•p API t∆∞∆°ng th√≠ch v·ªõi S3/Swift ƒë·ªÉ truy c·∫≠p object storage.

<b>CSI (Container Storage Interface) </b>: Interface ƒë·ªÉ k·∫øt n·ªëi gi·ªØa cluster v√†o h·ªá th·ªëng ceph.

--- 

## üìë M·ª•c L·ª•c

1. [C√°c lo·∫°i Storage CEPH](#cac-loai-storage-ceph)
2. [Rook - CloudNative Storage Orchestrator](#rook-ceph)

---
## C√°c lo·∫°i Storage CEPH
<h2 id="cac-loai-storage-ceph">üß∞ C√°c lo·∫°i Storage CEPH</h2>

| **Lo·∫°i Storage**              | **C√°ch l∆∞u tr·ªØ**                                        | **C√°ch truy c·∫≠p**                        | **·ª®ng d·ª•ng ph·ªï bi·∫øn**                                                                                                             |
| ----------------------------- | ------------------------------------------------------- | ---------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| **CephFS (File System)**      | L∆∞u file d∆∞·ªõi d·∫°ng object trong RADOS, metadata b·ªüi MDS | Mount qua kernel ho·∫∑c FUSE (gi·ªëng NFS)   | - Shared File System cho Kubernetes (RWX),L∆∞u tr·ªØ Home Directory, Big Data, AI/ML, HPC, L∆∞u tr·ªØ t√†i li·ªáu, d·ªØ li·ªáu logs, h√¨nh ·∫£nh          |
| **RBD (Block Storage)**       | L∆∞u block device d∆∞·ªõi d·∫°ng object trong RADOS           | G·∫Øn nh∆∞ m·ªôt ·ªï c·ª©ng (iSCSI, Kernel, QEMU) | - L∆∞u tr·ªØ ·ªï ƒëƒ©a ·∫£o cho VM (KVM, OpenStack, Proxmox),Persistent Volume cho Kubernetes (RWO), Database (MySQL, PostgreSQL, MongoDB) |
| **RGW (Object Storage - S3)** | L∆∞u object d∆∞·ªõi d·∫°ng key-value trong RADOS              | API S3, HTTP, REST                       | - Backup & Disaster Recovery, L∆∞u tr·ªØ Logs, AI/ML, Big Data, Static Website Hosting, Streaming Video & Media Storage              |

---

## Ph√¢n bi·ªát nhanh 3 lo·∫°i
| **Lo·∫°i Storage**     | **T∆∞∆°ng t·ª± nh∆∞** | **Giao th·ª©c**       | **D√πng v√†o vi·ªác**                |
|----------------------|------------------|----------------------|-----------------------------|
| **Ceph Block (RBD)**     | ·ªî ƒëƒ©a block      | CSI / librbd       | VM, C∆° s·ªü d·ªØ li·ªáu, Stateful Apps |
| **Ceph Object (RGW)**    | Amazon S3        | REST API (S3, Swift) | Web, Backup, Logs           |
| **Ceph File (CephFS)**   | File system      | POSIX                | HPC, Shared Storage         |

---

## So s√°nh lo·∫°i Storage CEPH

| **Lo·∫°i Storage**              | **File system tr√™n OSD** | **Hi·ªáu su·∫•t**                  | **∆Øu ƒëi·ªÉm**                                                                                  | **Nh∆∞·ª£c ƒëi·ªÉm**                                           | **Khi n√†o n√™n d√πng?**                                 |
| ----------------------------- | ------------------------ | ------------------------------ | -------------------------------------------------------------------------------------------- | -------------------------------------------------------- | ----------------------------------------------------- |
| **CephFS (File System)**      | XFS, Ext4                | Trung b√¨nh (ph·ª• thu·ªôc v√†o MDS) | - H·ªó tr·ª£ POSIX, Cho ph√©p nhi·ªÅu client truy c·∫≠p c√πng l√∫c, T·ª± ph·ª•c h·ªìi d·ªØ li·ªáu                 | - Hi·ªáu su·∫•t ph·ª• thu·ªôc v√†o MDS, Kh√¥ng t·ªëi ∆∞u cho file nh·ªè | Khi c·∫ßn m·ªôt h·ªá th·ªëng file chia s·∫ª gi·ªØa nhi·ªÅu m√°y ch·ªß. |
| **RBD (Block Storage)**       | XFS, Ext4                | Cao (n·∫øu d√πng SSD/NVMe)        | - Hi·ªáu su·∫•t cao, ph√π h·ª£p database, T√≠ch h·ª£p t·ªët v·ªõi OpenStack/Kubernetes,T·ª± ph·ª•c h·ªìi d·ªØ li·ªáu | - Kh√¥ng chia s·∫ª gi·ªØa nhi·ªÅu m√°y ch·ªß c√πng l√∫c (RWO)        | Khi c·∫ßn block storage cho VM, Kubernetes, Database.   |
| **RGW (Object Storage - S3)** | XFS, Ext4                | T·ªët cho object l·ªõn             | - M·ªü r·ªông v√¥ h·∫°n, H·ªó tr·ª£ S3 API, Chi ph√≠ th·∫•p h∆°n so v·ªõi CephFS/RBD                          | - Kh√¥ng th·ªÉ ch·ªânh s·ª≠a object, Kh√¥ng h·ªó tr·ª£ POSIX         | Khi c·∫ßn l∆∞u tr·ªØ d·ªØ li·ªáu l·ªõn, backup, CDN, streaming.  |

---

## L·ª±a ch·ªçn lo·∫°i Storage Ceph ph√π h·ª£p theo nhu c·∫ßu

| C·∫ßn l∆∞u tr·ªØ...                                           | N√™n ch·ªçn...                 | Gi·∫£i th√≠ch th√™m                                                                                                                                     |
| -------------------------------------------------------- | --------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| File theo chu·∫©n POSIX, d√πng chung gi·ªØa nhi·ªÅu server      | **‚úÖ CephFS**               | CephFS cung c·∫•p h·ªá th·ªëng file chia s·∫ª tu√¢n th·ªß POSIX, cho ph√©p nhi·ªÅu m√°y ch·ªß mount v√† truy c·∫≠p ƒë·ªìng th·ªùi.                                           |
| ·ªî c·ª©ng ·∫£o cho VM, database, Kubernetes Persistent Volume | **‚úÖ RBD (Block Storage)**  | RBD cung c·∫•p c√°c block device hi·ªáu su·∫•t cao, ph√π h·ª£p l√†m ·ªï ƒëƒ©a ·∫£o cho m√°y ·∫£o, persistent volume cho Kubernetes v√† backend cho database.             |
| D·ªØ li·ªáu ki·ªÉu Amazon S3 (Backup, Logs, Streaming, AI/ML)  | **‚úÖ RGW (Object Storage)** | RGW cung c·∫•p giao di·ªán t∆∞∆°ng th√≠ch S3, l√Ω t∆∞·ªüng cho l∆∞u tr·ªØ d·ªØ li·ªáu phi c·∫•u tr√∫c, backup, logs, streaming v√† d·ªØ li·ªáu cho AI/ML.                     |
| Hi·ªáu su·∫•t cao cho database, c·∫ßn t·ªëc ƒë·ªô ƒë·ªçc/ghi nhanh     | **‚úÖ RBD v·ªõi SSD/NVMe**     | S·ª≠ d·ª•ng RBD k·∫øt h·ª£p v·ªõi l·ªõp l∆∞u tr·ªØ SSD ho·∫∑c NVMe tr√™n c√°c OSD s·∫Ω mang l·∫°i hi·ªáu su·∫•t ƒë·ªçc/ghi cao, ƒë√°p ·ª©ng y√™u c·∫ßu c·ªßa database.                     |
| L∆∞u tr·ªØ ·∫£nh, video, logs v·ªõi kh·∫£ nƒÉng m·ªü r·ªông v√¥ h·∫°n     | **‚úÖ RGW**                  | RGW c√≥ kh·∫£ nƒÉng m·ªü r·ªông g·∫ßn nh∆∞ v√¥ h·∫°n, ph√π h·ª£p cho vi·ªác l∆∞u tr·ªØ l∆∞·ª£ng l·ªõn d·ªØ li·ªáu nh∆∞ ·∫£nh, video v√† logs.                                          |
| H·ªá th·ªëng file l·ªõn, c·∫ßn chia s·∫ª nhi·ªÅu user                | **‚úÖ CephFS v·ªõi nhi·ªÅu MDS** | ƒê·ªÉ x·ª≠ l√Ω l∆∞·ª£ng l·ªõn metadata v√† tƒÉng kh·∫£ nƒÉng ƒë·ªìng th·ªùi c·ªßa nhi·ªÅu user, vi·ªác tri·ªÉn khai CephFS v·ªõi nhi·ªÅu m√°y ch·ªß MDS (Metadata Server) l√† c·∫ßn thi·∫øt. |

---

<h2 id="rook-ceph">üß∞ Rook - CloudNative Storage Orchestrator</h2>
üèóÔ∏è **Rook Ceph Operator vs. Rook Ceph Cluster**: Kh√°c bi·ªát & C√°ch Ho·∫°t ƒê·ªông  
Trong h·ªá th·ªëng Rook Ceph, c√≥ hai th√†nh ph·∫ßn quan tr·ªçng khi tri·ªÉn khai b·∫±ng Helm Chart:

| Th√†nh ph·∫ßn             | Vai tr√≤                                                          |
| ---------------------- | ---------------------------------------------------------------- |
| **Rook Ceph Operator** | Tri·ªÉn khai Ceph Operator ƒë·ªÉ gi√°m s√°t v√† qu·∫£n l√Ω cluster          |
| **Rook Ceph Cluster**  | T·∫°o c√°c Custom Resources (CRs) ƒë·ªÉ Ceph Operator c·∫•u h√¨nh cluster |


### Architecture ROOK qu·∫£n l√Ω CEPH tr√™n Kubernetes

![Ceph ROOK High-Level Architecture](/static/images/ceph-rook.png 'Ceph ROOK High-Level Architecture')

